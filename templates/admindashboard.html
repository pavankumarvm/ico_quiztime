{% extends 'adminpanel.html' %} {% load static %} {% block head %}
<!-- <link
  rel="stylesheet"
  type="text/css"
  href="{% static 'css/dashboard.css' %}"
/> -->
<title>Admin Dashboard | ICO Quiz Time</title>
{% endblock head %} {% block body %}
<div class="container">
  <div class="col">
    <div class="row mx-4 mt-4">
      <h2 class="col-md-4">Admin Dashboard</h2>
      <h5 class="col-md-4 d-flex align-items-center justify-content-center">
        Total Users: {{total_users}}
      </h5>
      <h5 class="col-md-4 d-flex align-items-center justify-content-end">
        <form method="POST" action="/bajajauto/adminpanel/createReport/">
          {% csrf_token %}
          <button class="btn btn-primary mx-1" type="submit" id="create">
            Create Excel
          </button>
        </form>
        <a href="/media/excel/report.xlsx" download id="download">
          <button class="btn btn-success" type="button">
            Download Excel
          </button>
        </a>
      </h5>
      <hr />
    </div>
    <div class="row">
      <table class="table table-bordered" cellspacing="0" width="100%">
        <thead class="thead-dark">
          <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col">Last Login</th>
            <th scope="col">Block</th>
            <th scope="col">Delete</th>
            <th scope="col">Make Admin</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr id="{{user.user_id}}">
            <th scope="row">{{user.srno}}</th>
            <td>{{user.email}}</td>
            <td>{{user.last_login}}</td>
            <td>
              <form method="POST" action="/bajajauto/accounts/change_status/">
                {% csrf_token %}
                <input type="hidden" name="user_id" value="{{user.user_id}}" />
                {% if user.is_active %}<button type="submit" class="btn btn-danger mx-1">
                  Block User</button>{% else %}
                <button type="submit" class="btn btn-success mx-1">
                  Unblock User
                </button>
                {% endif %}
              </form>
            </td>
            <td>
              <form method="POST" action="/bajajauto/accounts/delete_user/">
                {% csrf_token %}
                <input type="hidden" name="user_id" value="{{user.user_id}}" />
                {% if user.is_active %}<button type="submit" class="btn btn-danger mx-1">
                  Delete User</button>{% else %}
                <button type="submit" class="btn btn-success mx-1">
                  Unblock User
                </button>
                {% endif %}
              </form>
            </td>
            <td>
              <form method="POST" action="/bajajauto/accounts/make_admin/">
                {% csrf_token %}
                <input type="hidden" name="user_id" value="{{user.user_id}}" />
                {% if user.is_admin %}<button type="submit" class="btn btn-danger mx-1">
                  Remove Admin</button>{% else %}
                <button type="submit" class="btn btn-success mx-1">
                  Make Admin
                </button>
                {% endif %}
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock body %}